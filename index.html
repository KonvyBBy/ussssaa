<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Konvy Accounts</title>
<style>
:root{ --bg:#000; --fg:#fff; --muted:#bdbdbd; --accent:#fff; --green:#0f0; --red:#f33; --orange:#fa0; }
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;color:var(--fg);background:var(--bg);}
body{display:flex;flex-direction:column;}
header{height:60px;display:flex;align-items:center;justify-content:space-between;padding:0 24px;border-bottom:1px solid rgba(255,255,255,0.1);}
.logo{font-size:24px;font-weight:700;}
main{flex:1;display:flex;overflow:hidden;}
.sidebar{width:250px;background:rgba(255,255,255,0.05);padding:20px;display:flex;flex-direction:column;gap:12px;}
.sidebar button{background:transparent;border:1px solid rgba(255,255,255,0.1);padding:10px;border-radius:8px;color:var(--fg);cursor:pointer;text-align:left;font-weight:600;}
.sidebar button.active{background:var(--accent);color:var(--bg);}
.content{flex:1;padding:24px;overflow-y:auto;}
h2{margin-top:0;color:var(--accent);}
.card{background:rgba(255,255,255,0.02);padding:20px;border-radius:12px;margin-bottom:12px;}
input,button{font-size:14px;}
input[type=text],input[type=password]{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);background:transparent;color:var(--fg);}
button{padding:10px;border:none;border-radius:8px;background:var(--fg);color:var(--bg);cursor:pointer;font-weight:700;}
table{width:100%;border-collapse:collapse;margin-top:12px;}
th,td{padding:8px;text-align:left;border-bottom:1px solid rgba(255,255,255,0.2);}
.hidden{display:none;}
#auth-screen{position:fixed;inset:0;background:var(--bg);display:flex;align-items:center;justify-content:center;z-index:1000;}
#auth-screen .card{max-width:360px;width:100%;padding:24px;}
.switcher{display:flex;gap:8px;margin-bottom:12px;}
.switcher button{background:transparent;border:1px solid rgba(255,255,255,0.1);color:var(--fg);padding:8px;border-radius:8px;flex:1;font-weight:600;cursor:pointer;}
.switcher button.active{background:var(--accent);color:var(--bg);}
.status-used{color:var(--red);font-weight:700;}
.status-unused{color:var(--green);font-weight:700;}
.status-pending{color:var(--orange);font-weight:700;}
.status-complete{color:var(--green);font-weight:700;}
</style>
</head>
<body>
<!-- AUTH SCREEN -->
<div id="auth-screen">
  <div class="card">
    <h2>Sign In / Sign Up</h2>
    <div class="switcher">
      <button id="btn-login" class="active">Login</button>
      <button id="btn-signup">Sign Up</button>
    </div>

    <form id="login-form">
      <label>Email</label>
      <input type="text" id="login-email" placeholder="you@example.com" required>
      <label>Password</label>
      <input type="password" id="login-password" placeholder="password" required>
      <button type="submit">Sign In</button>
    </form>

    <form id="signup-form" style="display:none;">
      <label>Username</label>
      <input type="text" id="signup-username" placeholder="Username" required>
      <label>Email</label>
      <input type="text" id="signup-email" placeholder="you@example.com" required>
      <label>Password</label>
      <input type="password" id="signup-password" placeholder="password" required>
      <button type="submit">Sign Up</button>
    </form>
  </div>
</div>

<header>
  <div class="logo">Konvy</div>
  <div>
    <span id="welcome">Welcome</span> | <span id="user-email">Not signed in</span>
    <button id="logout-btn" class="hidden">Logout</button>
  </div>
</header>

<main>
  <div class="sidebar">
    <button id="menu-dashboard" class="active">Dashboard</button>
    <button id="menu-redeem">Redeem Key</button>
    <button id="menu-orders">My Orders</button>
    <button id="menu-tickets">Tickets</button>
    <button id="menu-owner" class="hidden">Owner Panel</button>
  </div>
  <div class="content" id="main-content">
    <div id="dashboard-view">
      <h2>Dashboard</h2>
      <div class="card">Welcome to your account dashboard.</div>
    </div>

    <div id="redeem-view" class="hidden">
      <h2>Redeem Key</h2>
      <div class="card">
        <input type="text" id="redeem-key-input" placeholder="Enter product key">
        <button id="redeem-key-btn">Redeem</button>
      </div>
    </div>

    <div id="orders-view" class="hidden">
      <h2>My Orders</h2>
      <table>
        <thead>
          <tr><th>Product</th><th>Redeemed At</th><th>Status</th></tr>
        </thead>
        <tbody id="orders-list"></tbody>
      </table>
    </div>

    <div id="tickets-view" class="hidden">
      <h2>Tickets</h2>
      <div id="ticket-box"></div>
      <div id="ticket-controls"></div>
    </div>

    <div id="owner-view" class="hidden">
      <h2>Owner Panel</h2>
      <div class="card">
        <h4>Create Key</h4>
        <input type="text" id="owner-product-name" placeholder="Product Name">
        <input type="text" id="owner-key" placeholder="Key">
        <button id="create-key-btn">Create Key</button>
      </div>
      <div class="card">
        <h4>All Keys</h4>
        <table>
          <thead><tr><th>Key</th><th>Product</th><th>Status</th><th>Redeemed By</th></tr></thead>
          <tbody id="keys-list"></tbody>
        </table>
      </div>
    </div>
  </div>
</main>

<footer>Built with Firebase</footer>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyD2M35gv68ILULRqlRVlO5E4oLCXbj1RaM",
  authDomain: "konvy-57910.firebaseapp.com",
  projectId: "konvy-57910",
  storageBucket: "konvy-57910.firebasestorage.app",
  messagingSenderId: "97699914787",
  appId: "1:97699914787:web:f2ba164292f3a3f07ebd96",
  measurementId: "G-330N3W9E4N"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// Elements
const authScreen=document.getElementById('auth-screen');
const btnLogin=document.getElementById('btn-login');
const btnSignup=document.getElementById('btn-signup');
const loginForm=document.getElementById('login-form');
const signupForm=document.getElementById('signup-form');

btnLogin.addEventListener("click", ()=>{btnLogin.classList.add("active");btnSignup.classList.remove("active");loginForm.style.display="block";signupForm.style.display="none";});
btnSignup.addEventListener("click", ()=>{btnSignup.classList.add("active");btnLogin.classList.remove("active");loginForm.style.display="none";signupForm.style.display="block";});

// Signup
signupForm.addEventListener("submit", async e=>{
  e.preventDefault();
  const username=document.getElementById("signup-username").value.trim();
  const email=document.getElementById("signup-email").value.trim();
  const password=document.getElementById("signup-password").value;
  try{
    const cred=await auth.createUserWithEmailAndPassword(email,password);
    await db.collection("users").doc(cred.user.uid).set({username,role:"user"});
    alert("Signup successful! Please login.");
  }catch(err){alert(err.message);}
});

// Login
loginForm.addEventListener("submit", async e=>{
  e.preventDefault();
  const email=document.getElementById("login-email").value.trim();
  const password=document.getElementById("login-password").value;
  try{await auth.signInWithEmailAndPassword(email,password);}catch(err){alert(err.message);}
});

// Auth state
auth.onAuthStateChanged(async user=>{
  if(user){
    authScreen.style.display="none";
  }else{
    authScreen.style.display="flex";
  }
});
</script>
</body>
</html>
